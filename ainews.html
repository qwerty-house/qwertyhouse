{
  en: {
    dashboard: "Dashboard",
    calendar: "Calendar",
    market: "Market",
    saved: "Saved",
    settings: "Settings",
    briefing: "Today's Briefing",
    savedTitle: "Saved Intelligence",
    live: "Live",
    searchPlaceholder: "Search intelligence...",
    source: "Source",
    readReport: "Read Full Report",
    analysis: "Nexus Intelligence",
    volatilityAlert: "Volatility Alert",
    volatilityMsg: "AI Sector ETF (AIQ) is showing unusual option volume in the $32.5 strike. Institutional rotation from Hardware to Software layers detected.",
    prefTitle: "Platform Preferences",
    pushNotif: "Push Notifications",
    pushDesc: "Get alerts for impact scores > 90",
    autoStream: "Live Data Stream",
    autoStreamDesc: "Auto-refresh feeds every 10s",
    telegramAuto: "Telegram Auto-Post",
    telegramDesc: "Forward high-impact news to channel",
    dataSources: "Data Sources",
    instructions: "Instructions",
    calendarInstruct: "Select a date on the calendar to filter the global intelligence feed. Green dots indicate days with significant market-moving events.",
    archive: "Archive",
    noUpdates: "No updates found matching criteria.",
    shareToast: "Link copied to clipboard",
    saveToast: "Added to Saved Items",
    unsaveToast: "Removed from Saved Items",
    tgSentToast: "ðŸš€ Sent to Telegram Channel",
    broadcastTg: "Broadcast to Telegram",
    selectDate: "Select a date to view archive",
    updatesFor: "Updates for"
  },
  th: {
    dashboard: "à¹à¸”à¸Šà¸šà¸­à¸£à¹Œà¸”",
    calendar: "à¸›à¸à¸´à¸—à¸´à¸™",
    market: "à¸•à¸¥à¸²à¸”",
    saved: "à¸šà¸±à¸™à¸—à¸¶à¸à¹à¸¥à¹‰à¸§",
    settings: "à¸•à¸±à¹‰à¸‡à¸„à¹ˆà¸²",
    briefing: "à¸ªà¸£à¸¸à¸›à¸‚à¹ˆà¸²à¸§à¸§à¸±à¸™à¸™à¸µà¹‰",
    savedTitle: "à¸‚à¹ˆà¸²à¸§à¸—à¸µà¹ˆà¸šà¸±à¸™à¸—à¸¶à¸à¹„à¸§à¹‰",
    live: "à¸ªà¸”",
    searchPlaceholder: "à¸„à¹‰à¸™à¸«à¸²à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸­à¸±à¸ˆà¸‰à¸£à¸´à¸¢à¸°...",
    source: "à¸—à¸µà¹ˆà¸¡à¸²",
    readReport: "à¸­à¹ˆà¸²à¸™à¸£à¸²à¸¢à¸‡à¸²à¸™à¸‰à¸šà¸±à¸šà¹€à¸•à¹‡à¸¡",
    analysis: "à¸šà¸—à¸§à¸´à¹€à¸„à¸£à¸²à¸°à¸«à¹Œ Nexus",
    volatilityAlert: "à¹à¸ˆà¹‰à¸‡à¹€à¸•à¸·à¸­à¸™à¸„à¸§à¸²à¸¡à¸œà¸±à¸™à¸œà¸§à¸™",
    volatilityMsg: "à¸à¸­à¸‡à¸—à¸¸à¸™ AI Sector ETF (AIQ) à¸¡à¸µà¸›à¸£à¸´à¸¡à¸²à¸“à¸à¸²à¸£à¸‹à¸·à¹‰à¸­à¸‚à¸²à¸¢ Option à¸œà¸´à¸”à¸›à¸à¸•à¸´à¸—à¸µà¹ˆà¸£à¸²à¸„à¸²à¹ƒà¸Šà¹‰à¸ªà¸´à¸—à¸˜à¸´ $32.5 à¸•à¸£à¸§à¸ˆà¸žà¸šà¸à¸²à¸£à¸¢à¹‰à¸²à¸¢à¹€à¸‡à¸´à¸™à¸—à¸¸à¸™à¸ˆà¸²à¸à¸à¸¥à¸¸à¹ˆà¸¡à¸®à¸²à¸£à¹Œà¸”à¹à¸§à¸£à¹Œà¸ªà¸¹à¹ˆà¸‹à¸­à¸Ÿà¸•à¹Œà¹à¸§à¸£à¹Œ",
    prefTitle: "à¸à¸²à¸£à¸•à¸±à¹‰à¸‡à¸„à¹ˆà¸²à¹à¸žà¸¥à¸•à¸Ÿà¸­à¸£à¹Œà¸¡",
    pushNotif: "à¸à¸²à¸£à¹à¸ˆà¹‰à¸‡à¹€à¸•à¸·à¸­à¸™ (Push)",
    pushDesc: "à¹à¸ˆà¹‰à¸‡à¹€à¸•à¸·à¸­à¸™à¹€à¸¡à¸·à¹ˆà¸­à¸„à¸°à¹à¸™à¸™à¸œà¸¥à¸à¸£à¸°à¸—à¸š > 90",
    autoStream: "à¸ªà¸•à¸£à¸µà¸¡à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸ªà¸”",
    autoStreamDesc: "à¸£à¸µà¹€à¸Ÿà¸£à¸Šà¸Ÿà¸µà¸”à¸­à¸±à¸•à¹‚à¸™à¸¡à¸±à¸•à¸´à¸—à¸¸à¸ 10 à¸§à¸´à¸™à¸²à¸—à¸µ",
    telegramAuto: "à¹‚à¸žà¸ªà¸•à¹Œà¸¥à¸‡ Telegram à¸­à¸±à¸•à¹‚à¸™à¸¡à¸±à¸•à¸´",
    telegramDesc: "à¸ªà¹ˆà¸‡à¸‚à¹ˆà¸²à¸§à¸ªà¸³à¸„à¸±à¸à¹„à¸›à¸¢à¸±à¸‡à¸Šà¹ˆà¸­à¸‡à¸‚à¸­à¸‡à¸„à¸¸à¸“à¸—à¸±à¸™à¸—à¸µ",
    dataSources: "à¹à¸«à¸¥à¹ˆà¸‡à¸‚à¹‰à¸­à¸¡à¸¹à¸¥",
    instructions: "à¸„à¸³à¹à¸™à¸°à¸™à¸³",
    calendarInstruct: "à¹€à¸¥à¸·à¸­à¸à¸§à¸±à¸™à¸—à¸µà¹ˆà¸šà¸™à¸›à¸à¸´à¸—à¸´à¸™à¹€à¸žà¸·à¹ˆà¸­à¸à¸£à¸­à¸‡à¸Ÿà¸µà¸”à¸‚à¹ˆà¸²à¸§ à¸ˆà¸¸à¸”à¸ªà¸µà¹€à¸‚à¸µà¸¢à¸§à¹à¸ªà¸”à¸‡à¸–à¸¶à¸‡à¸§à¸±à¸™à¸—à¸µà¹ˆà¸¡à¸µà¹€à¸«à¸•à¸¸à¸à¸²à¸£à¸“à¹Œà¸ªà¸³à¸„à¸±à¸à¸—à¸µà¹ˆà¸ªà¹ˆà¸‡à¸œà¸¥à¸•à¹ˆà¸­à¸•à¸¥à¸²à¸”",
    archive: "à¸„à¸¥à¸±à¸‡à¸‚à¹‰à¸­à¸¡à¸¹à¸¥",
    noUpdates: "à¹„à¸¡à¹ˆà¸žà¸šà¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸—à¸µà¹ˆà¸•à¸£à¸‡à¸à¸±à¸šà¹€à¸‡à¸·à¹ˆà¸­à¸™à¹„à¸‚",
    shareToast: "à¸„à¸±à¸”à¸¥à¸­à¸à¸¥à¸´à¸‡à¸à¹Œà¹€à¸£à¸µà¸¢à¸šà¸£à¹‰à¸­à¸¢à¹à¸¥à¹‰à¸§",
    saveToast: "à¸šà¸±à¸™à¸—à¸¶à¸à¸£à¸²à¸¢à¸à¸²à¸£à¹à¸¥à¹‰à¸§",
    unsaveToast: "à¸¥à¸šà¸­à¸­à¸à¸ˆà¸²à¸à¸£à¸²à¸¢à¸à¸²à¸£à¸šà¸±à¸™à¸—à¸¶à¸à¹à¸¥à¹‰à¸§",
    tgSentToast: "ðŸš€ à¸ªà¹ˆà¸‡à¹„à¸›à¸¢à¸±à¸‡à¸Šà¹ˆà¸­à¸‡ Telegram à¹à¸¥à¹‰à¸§",
    broadcastTg: "à¸šà¸£à¸­à¸”à¹à¸„à¸ªà¸•à¹Œà¹„à¸›à¸¢à¸±à¸‡ Telegram",
    selectDate: "à¹€à¸¥à¸·à¸­à¸à¸§à¸±à¸™à¸—à¸µà¹ˆà¹€à¸žà¸·à¹ˆà¸­à¸”à¸¹à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸¢à¹‰à¸­à¸™à¸«à¸¥à¸±à¸‡",
    updatesFor: "à¸­à¸±à¸›à¹€à¸”à¸•à¸ªà¸³à¸«à¸£à¸±à¸šà¸§à¸±à¸™à¸—à¸µà¹ˆ"
  }
};

const FILTER_CATEGORIES = [
  { id: 'all', label: { en: 'All Updates', th: 'à¸—à¸±à¹‰à¸‡à¸«à¸¡à¸”' } },
  { id: 'Business', label: { en: 'Business', th: 'à¸˜à¸¸à¸£à¸à¸´à¸ˆ' }, icon: Briefcase },
  { id: 'Success Case', label: { en: 'Success Stories', th: 'à¸à¸£à¸“à¸µà¸¨à¸¶à¸à¸©à¸²' }, icon: Trophy },
  { id: 'Tool Launch', label: { en: 'New Tools', th: 'à¹€à¸„à¸£à¸·à¹ˆà¸­à¸‡à¸¡à¸·à¸­à¹ƒà¸«à¸¡à¹ˆ' }, icon: Wrench },
  { id: 'Social Promo', label: { en: 'Social Media AI', th: 'à¹‚à¸‹à¹€à¸Šà¸µà¸¢à¸¥à¸¡à¸µà¹€à¸”à¸µà¸¢' }, icon: Share2 },
  { id: 'Tips & Tricks', label: { en: 'Tips & Tricks', th: 'à¹€à¸„à¸¥à¹‡à¸”à¸¥à¸±à¸š' }, icon: Lightbulb },
];

const INITIAL_TICKERS = [
  { symbol: "NVDA", price: 924.12, change: 3.4 },
  { symbol: "MSFT", price: 412.50, change: 0.8 },
  { symbol: "GOOGL", price: 172.15, change: -1.2 },
  { symbol: "TAO", price: 420.00, change: 15.2 },
  { symbol: "FET", price: 2.45, change: 5.1 },
  { symbol: "PLTR", price: 24.50, change: 2.1 },
  { symbol: "AMD", price: 170.20, change: -0.5 },
  { symbol: "META", price: 485.10, change: 1.2 },
];

// Helper to create dates relative to today
const daysAgo = (days) => {
  const date = new Date();
  date.setDate(date.getDate() - days);
  return date.getTime();
};

const INITIAL_NEWS = [
  {
    id: 'n1',
    title: { en: "STOP Paying $20/mo for ChatGPT? ðŸ›‘", th: "à¹€à¸¥à¸´à¸à¸ˆà¹ˆà¸²à¸¢ 700 à¸šà¸²à¸—à¹ƒà¸«à¹‰ ChatGPT à¹„à¸”à¹‰à¹à¸¥à¹‰à¸§? ðŸ›‘" },
    subtitle: { en: "DeepSeek just killed the subscription model forever.", th: "DeepSeek à¹€à¸žà¸´à¹ˆà¸‡à¸†à¹ˆà¸²à¹‚à¸¡à¹€à¸”à¸¥ Subscription à¸—à¸´à¹‰à¸‡à¸–à¸²à¸§à¸£" },
    source: "DeepSeek AI",
    sourceUrl: "https://chat.deepseek.com",
    time: daysAgo(0),
    category: "Tool Launch",
    impactScore: 99,
    sentiment: "bullish",
    assets: ["FREE", "OPEN"],
    summary: { 
      en: "Why are you still paying for premium AI? DeepSeek V3 just dropped, and benchmarks show it matching GPT-4o toe-to-toe... for FREE. We tested it on coding, creative writing, and logic. The results are embarrassing for Big Tech. Here is how to switch your workflow today and save $240/year.",
      th: "à¸—à¸³à¹„à¸¡à¸„à¸¸à¸“à¸¢à¸±à¸‡à¸ˆà¹ˆà¸²à¸¢à¹€à¸‡à¸´à¸™à¸„à¹ˆà¸² AI à¸£à¸²à¸¢à¹€à¸”à¸·à¸­à¸™à¸­à¸¢à¸¹à¹ˆ? DeepSeek V3 à¹€à¸žà¸´à¹ˆà¸‡à¹€à¸›à¸´à¸”à¸•à¸±à¸§ à¹à¸¥à¸°à¸œà¸¥à¸—à¸”à¸ªà¸­à¸š Benchmark à¸Šà¸™à¸° GPT-4o à¹„à¸”à¹‰à¹€à¸à¸·à¸­à¸šà¸—à¸¸à¸à¸”à¹‰à¸²à¸™... à¸—à¸µà¹ˆà¸ªà¸³à¸„à¸±à¸à¸„à¸·à¸­à¸Ÿà¸£à¸µ! à¹€à¸£à¸²à¸—à¸”à¸ªà¸­à¸šà¸—à¸±à¹‰à¸‡à¸à¸²à¸£à¹€à¸‚à¸µà¸¢à¸™à¹‚à¸„à¹‰à¸” à¸‡à¸²à¸™à¹€à¸‚à¸µà¸¢à¸™ à¹à¸¥à¸°à¸•à¸£à¸£à¸à¸° à¸œà¸¥à¸¥à¸±à¸žà¸˜à¹Œà¸—à¸³à¹€à¸­à¸² Big Tech à¸•à¹‰à¸­à¸‡à¸­à¸²à¸¢ à¸™à¸µà¹ˆà¸„à¸·à¸­à¸§à¸´à¸˜à¸µà¹€à¸›à¸¥à¸µà¹ˆà¸¢à¸™ Workflow à¸‚à¸­à¸‡à¸„à¸¸à¸“à¸§à¸±à¸™à¸™à¸µà¹‰à¹à¸¥à¸°à¸›à¸£à¸°à¸«à¸¢à¸±à¸”à¹€à¸‡à¸´à¸™à¹„à¸”à¹‰ 8,000 à¸šà¸²à¸—à¸•à¹ˆà¸­à¸›à¸µ"
    },
    aiTakeaway: {
      en: "Open-source models have finally caught up. The era of the expensive 'AI Tax' is ending.",
      th: "à¹‚à¸¡à¹€à¸”à¸¥ Open-source à¸•à¸²à¸¡à¸—à¸±à¸™à¹à¸¥à¹‰à¸§ à¸¢à¸¸à¸„à¸‚à¸­à¸‡à¸à¸²à¸£à¸ˆà¹ˆà¸²à¸¢ 'à¸ à¸²à¸©à¸µ AI' à¹à¸žà¸‡à¹† à¸à¸³à¸¥à¸±à¸‡à¸ˆà¸°à¸ˆà¸šà¸¥à¸‡"
    },
    metrics: [
      { label: "Price", value: "$0" },
      { label: "IQ", value: "High" }
    ]
  },
  {
    id: 'n2',
    title: { en: "The '3-Step' Prompt Hack ðŸ§ ", th: "à¹€à¸—à¸„à¸™à¸´à¸„ Prompt 3 à¸‚à¸±à¹‰à¸™à¸•à¸­à¸™ (à¸à¹‡à¸­à¸›à¹„à¸›à¹ƒà¸Šà¹‰à¹„à¸”à¹‰à¹€à¸¥à¸¢) ðŸ§ " },
    subtitle: { en: "Get 10x better results instantly (Copy-Paste this).", th: "à¸œà¸¥à¸¥à¸±à¸žà¸˜à¹Œà¸”à¸µà¸‚à¸¶à¹‰à¸™ 10 à¹€à¸—à¹ˆà¸²à¸—à¸±à¸™à¸—à¸µ à¹à¸„à¹ˆà¸—à¸³à¸•à¸²à¸¡à¸™à¸µà¹‰" },
    source: "AI Explained",
    sourceUrl: "https://twitter.com",
    time: daysAgo(1),
    category: "Tips & Tricks",
    impactScore: 98,
    sentiment: "bullish",
    assets: ["PROMPTS"],
    summary: {
      en: "Stop getting generic robot answers. 90% of people prompt wrong. Use the 'C-O-F' method: Context (Who are you?), Objective (What do you want?), Format (Table/List/Code). We tried this on a basic email request and the difference in quality was night and day. Don't prompt harder, prompt smarter.",
      th: "à¹€à¸¥à¸´à¸à¸—à¸™à¸à¸±à¸šà¸„à¸³à¸•à¸­à¸šà¸«à¸¸à¹ˆà¸™à¸¢à¸™à¸•à¹Œà¸‹à¹‰à¸³à¸‹à¸²à¸ 90% à¸‚à¸­à¸‡à¸„à¸™à¹ƒà¸Šà¹‰ AI à¹€à¸‚à¸µà¸¢à¸™ Prompt à¸œà¸´à¸” à¸§à¸´à¸˜à¸µà¹à¸à¹‰à¸„à¸·à¸­à¸ªà¸¹à¸•à¸£ 'C-O-F': Context (à¸„à¸¸à¸“à¹€à¸›à¹‡à¸™à¹ƒà¸„à¸£?), Objective (à¸•à¹‰à¸­à¸‡à¸à¸²à¸£à¸­à¸°à¹„à¸£?), Format (à¸•à¸²à¸£à¸²à¸‡/à¸¥à¸´à¸ªà¸•à¹Œ/à¹‚à¸„à¹‰à¸”) à¹€à¸£à¸²à¸¥à¸­à¸‡à¹ƒà¸Šà¹‰à¸ªà¸¹à¸•à¸£à¸™à¸µà¹‰à¹€à¸‚à¸µà¸¢à¸™à¸­à¸µà¹€à¸¡à¸¥ à¸œà¸¥à¸¥à¸±à¸žà¸˜à¹Œà¸•à¹ˆà¸²à¸‡à¸à¸±à¸™à¸£à¸²à¸§à¸Ÿà¹‰à¸²à¸à¸±à¸šà¹€à¸«à¸§ à¸­à¸¢à¹ˆà¸²à¸‚à¸¢à¸±à¸™à¸œà¸´à¸”à¸—à¸µà¹ˆ à¸ˆà¸‡à¸‰à¸¥à¸²à¸”à¹ƒà¸Šà¹‰à¹€à¸„à¸£à¸·à¹ˆà¸­à¸‡à¸¡à¸·à¸­"
    },
    aiTakeaway: {
      en: "Context windows are large enough now that 'lazy' prompting is the only bottleneck to quality output.",
      th: "Context window à¹ƒà¸«à¸à¹ˆà¸žà¸­à¹à¸¥à¹‰à¸§ à¸›à¸±à¸à¸«à¸²à¹€à¸”à¸µà¸¢à¸§à¸—à¸µà¹ˆà¸—à¸³à¹ƒà¸«à¹‰à¸‡à¸²à¸™à¹„à¸¡à¹ˆà¸”à¸µà¸„à¸·à¸­à¸à¸²à¸£à¹€à¸‚à¸µà¸¢à¸™ Prompt à¹à¸šà¸š 'à¸¡à¸±à¸à¸‡à¹ˆà¸²à¸¢'"
    },
    metrics: [
      { label: "Effort", value: "Low" },
      { label: "Output", value: "10x" }
    ]
  },
  {
    id: 'n3',
    title: { en: "Coding is Dead. Long Live Coding. ðŸ’€", th: "à¸à¸²à¸£à¹€à¸‚à¸µà¸¢à¸™à¹‚à¸„à¹‰à¸”à¹à¸šà¸šà¹€à¸”à¸´à¸¡à¸•à¸²à¸¢à¹à¸¥à¹‰à¸§ ðŸ’€" },
    subtitle: { en: "How Cursor AI turns you into a Senior Dev overnight.", th: "à¸§à¸´à¸˜à¸µà¸—à¸µà¹ˆ Cursor AI à¹€à¸›à¸¥à¸µà¹ˆà¸¢à¸™à¸„à¸¸à¸“à¹€à¸›à¹‡à¸™ Senior Dev à¹ƒà¸™à¸‚à¹‰à¸²à¸¡à¸„à¸·à¸™" },
    source: "Cursor",
    sourceUrl: "https://cursor.sh",
    time: daysAgo(2),
    category: "Tool Launch",
    impactScore: 95,
    sentiment: "bullish",
    assets: ["MSFT", "VSCODE"],
    summary: {
      en: "If you are still typing every character of code manually, you are working in the stone age. Cursor isn't just autocomplete; it predicts your next 5 edits. Beginners are building full SaaS apps in weekends. Pros are shipping 30% faster. Is this the end of the Junior Dev role, or the rise of the '100x Engineer'?",
      th: "à¸–à¹‰à¸²à¸„à¸¸à¸“à¸¢à¸±à¸‡à¸žà¸´à¸¡à¸žà¹Œà¹‚à¸„à¹‰à¸”à¸—à¸µà¸¥à¸°à¸•à¸±à¸§à¸­à¸±à¸à¸©à¸£ à¸„à¸¸à¸“à¸à¸³à¸¥à¸±à¸‡à¸—à¸³à¸‡à¸²à¸™à¹ƒà¸™à¸¢à¸¸à¸„à¸«à¸´à¸™ Cursor à¹„à¸¡à¹ˆà¹ƒà¸Šà¹ˆà¹à¸„à¹ˆ Autocomplete à¹à¸•à¹ˆà¸¡à¸±à¸™à¹€à¸”à¸²à¹ƒà¸ˆà¸„à¸¸à¸“à¹„à¸”à¹‰à¸¥à¹ˆà¸§à¸‡à¸«à¸™à¹‰à¸² 5 à¸šà¸£à¸£à¸—à¸±à¸” à¸¡à¸·à¸­à¹ƒà¸«à¸¡à¹ˆà¸ªà¸£à¹‰à¸²à¸‡à¹à¸­à¸› SaaS à¹€à¸ªà¸£à¹‡à¸ˆà¹ƒà¸™à¸§à¸±à¸™à¸«à¸¢à¸¸à¸” à¸¡à¸·à¸­à¹‚à¸›à¸£à¸—à¸³à¸‡à¸²à¸™à¹„à¸§à¸‚à¸¶à¹‰à¸™ 30% à¸™à¸µà¹ˆà¸„à¸·à¸­à¸ˆà¸¸à¸”à¸ˆà¸šà¸‚à¸­à¸‡ Junior Dev à¸«à¸£à¸·à¸­à¸ˆà¸¸à¸”à¹€à¸£à¸´à¹ˆà¸¡à¸•à¹‰à¸™à¸‚à¸­à¸‡ '100x Engineer' à¸à¸±à¸™à¹à¸™à¹ˆ?"
    },
    aiTakeaway: {
      en: "Integrated AI environments are replacing standard text editors. Adapt or become obsolete.",
      th: "IDE à¸—à¸µà¹ˆà¸¡à¸µ AI à¸à¸±à¸‡à¸•à¸±à¸§à¸à¸³à¸¥à¸±à¸‡à¸ˆà¸°à¹à¸—à¸™à¸—à¸µà¹ˆ Text Editor à¸—à¸±à¹ˆà¸§à¹„à¸› à¸›à¸£à¸±à¸šà¸•à¸±à¸§à¸‹à¸° à¸«à¸£à¸·à¸­à¸ˆà¸°à¸à¸¥à¸²à¸¢à¹€à¸›à¹‡à¸™à¸„à¸™à¸•à¸à¸¢à¸¸à¸„"
    },
    metrics: [
      { label: "Speed", value: "+40%" },
      { label: "Bugs", value: "-90%" }
    ]
  },
  {
    id: 'n4',
    title: { en: "Instagram Algorithm LEAKED? ðŸš¨", th: "à¸­à¸±à¸¥à¸à¸­à¸£à¸´à¸—à¸¶à¸¡ IG à¸«à¸¥à¸¸à¸”? ðŸš¨" },
    subtitle: { en: "The exact keywords getting 10x reach right now.", th: "à¸„à¸µà¸¢à¹Œà¹€à¸§à¸´à¸£à¹Œà¸”à¸¥à¸±à¸šà¸—à¸µà¹ˆà¹€à¸žà¸´à¹ˆà¸¡à¸à¸²à¸£à¹€à¸‚à¹‰à¸²à¸–à¸¶à¸‡ 10 à¹€à¸—à¹ˆà¸²à¸•à¸­à¸™à¸™à¸µà¹‰" },
    source: "Social Media Today",
    sourceUrl: "https://instagram.com", 
    time: daysAgo(3),
    category: "Social Promo",
    impactScore: 92,
    sentiment: "bullish",
    assets: ["META"],
    summary: {
      en: "Internal documents suggest IG is prioritizing 'AI-native' visual styles. We analyzed 50 viral accounts from last month. The common thread? They all used specific AI upscaling tools and caption hooks. Here is the breakdown of the 'Viral Stack' you need to be using in 2025 to grow your brand.",
      th: "à¹€à¸­à¸à¸ªà¸²à¸£à¸ à¸²à¸¢à¹ƒà¸™à¸Šà¸µà¹‰ IG à¸à¸³à¸¥à¸±à¸‡à¸”à¸±à¸™à¸ à¸²à¸žà¸ªà¹„à¸•à¸¥à¹Œ 'AI-native' à¹€à¸£à¸²à¸§à¸´à¹€à¸„à¸£à¸²à¸°à¸«à¹Œ 50 à¸šà¸±à¸à¸Šà¸µà¹„à¸§à¸£à¸±à¸¥à¹€à¸”à¸·à¸­à¸™à¸—à¸µà¹ˆà¹à¸¥à¹‰à¸§ à¸ˆà¸¸à¸”à¸£à¹ˆà¸§à¸¡à¸„à¸·à¸­? à¸žà¸§à¸à¹€à¸‚à¸²à¹ƒà¸Šà¹‰à¹€à¸„à¸£à¸·à¹ˆà¸­à¸‡à¸¡à¸·à¸­ AI Upscale à¹à¸¥à¸° Caption Hook à¸ªà¸¹à¸•à¸£à¹€à¸‰à¸žà¸²à¸° à¸™à¸µà¹ˆà¸„à¸·à¸­ 'Viral Stack' à¸—à¸µà¹ˆà¸„à¸¸à¸“à¸•à¹‰à¸­à¸‡à¹ƒà¸Šà¹‰à¹ƒà¸™à¸›à¸µ 2025 à¸–à¹‰à¸²à¸­à¸¢à¸²à¸à¹‚à¸•"
    },
    aiTakeaway: {
      en: "Algorithms are now detecting and boosting high-fidelity AI content. Aesthetic quality is the new SEO.",
      th: "à¸­à¸±à¸¥à¸à¸­à¸£à¸´à¸—à¸¶à¸¡à¹€à¸£à¸´à¹ˆà¸¡à¸ˆà¸±à¸šà¹à¸¥à¸°à¸”à¸±à¸™à¸„à¸­à¸™à¹€à¸—à¸™à¸•à¹Œ AI à¸„à¸¸à¸“à¸ à¸²à¸žà¸ªà¸¹à¸‡ à¸„à¸§à¸²à¸¡à¸ªà¸§à¸¢à¸‡à¸²à¸¡à¸„à¸·à¸­ SEO à¹à¸šà¸šà¹ƒà¸«à¸¡à¹ˆ"
    },
    metrics: [
      { label: "Reach", value: "10x" },
      { label: "Growth", value: "Fast" }
    ]
  },
  {
    id: 'n5',
    title: { en: "Sora is Live: Hollywood Panic ðŸŽ¥", th: "Sora à¸¡à¸²à¹à¸¥à¹‰à¸§: à¸®à¸­à¸¥à¸¥à¸µà¸§à¸¹à¸”à¸ªà¸±à¹ˆà¸™à¸ªà¸°à¹€à¸—à¸·à¸­à¸™ ðŸŽ¥" },
    subtitle: { en: "Generate movies from text. Reality is optional.", th: "à¸ªà¸£à¹‰à¸²à¸‡à¸«à¸™à¸±à¸‡à¸ˆà¸²à¸à¸‚à¹‰à¸­à¸„à¸§à¸²à¸¡ à¸„à¸§à¸²à¸¡à¸ˆà¸£à¸´à¸‡à¹€à¸›à¹‡à¸™à¹à¸„à¹ˆà¸—à¸²à¸‡à¹€à¸¥à¸·à¸­à¸" },
    source: "OpenAI",
    sourceUrl: "https://openai.com/sora",
    time: daysAgo(4),
    category: "Tool Launch",
    impactScore: 94,
    sentiment: "neutral",
    assets: ["ADBE"],
    summary: {
      en: "Stock footage libraries are on suicide watch. OpenAI's Sora is now generating minute-long videos with perfect physics. We typed 'Cyberpunk Tokyo in rain' and got a clip that looks like a $50M movie production. What does this mean for filmmakers, YouTubers, and reality itself? See the demos.",
      th: "à¹€à¸§à¹‡à¸šà¸‚à¸²à¸¢ Stock Video à¹€à¸•à¸£à¸µà¸¢à¸¡à¹€à¸ˆà¹Šà¸‡ OpenAI Sora à¸ªà¸£à¹‰à¸²à¸‡à¸§à¸´à¸”à¸µà¹‚à¸­ 1 à¸™à¸²à¸—à¸µà¸žà¸£à¹‰à¸­à¸¡à¸Ÿà¸´à¸ªà¸´à¸à¸ªà¹Œà¸ªà¸¡à¸ˆà¸£à¸´à¸‡ à¹€à¸£à¸²à¸žà¸´à¸¡à¸žà¹Œ 'Cyberpunk Tokyo in rain' à¹„à¸”à¹‰à¸„à¸¥à¸´à¸›à¸—à¸µà¹ˆà¹€à¸«à¸¡à¸·à¸­à¸™à¸«à¸™à¸±à¸‡à¸—à¸¸à¸™à¸ªà¸£à¹‰à¸²à¸‡ 50 à¸¥à¹‰à¸²à¸™à¸”à¸­à¸¥à¸¥à¸²à¸£à¹Œ à¸™à¸µà¹ˆà¸«à¸¡à¸²à¸¢à¸„à¸§à¸²à¸¡à¸§à¹ˆà¸²à¸¢à¸±à¸‡à¹„à¸‡à¸ªà¸³à¸«à¸£à¸±à¸šà¸„à¸™à¸—à¸³à¸«à¸™à¸±à¸‡ à¸¢à¸¹à¸—à¸¹à¸›à¹€à¸šà¸­à¸£à¹Œ à¹à¸¥à¸°à¸„à¸§à¸²à¸¡à¸ˆà¸£à¸´à¸‡? à¸”à¸¹à¹€à¸”à¹‚à¸¡à¹€à¸¥à¸¢"
    },
    aiTakeaway: {
      en: "Video production costs are collapsing to zero. The value is now in the 'Idea', not the 'Execution'.",
      th: "à¸•à¹‰à¸™à¸—à¸¸à¸™à¸à¸²à¸£à¸œà¸¥à¸´à¸•à¸§à¸´à¸”à¸µà¹‚à¸­à¸à¸³à¸¥à¸±à¸‡à¸ˆà¸°à¹€à¸›à¹‡à¸™à¸¨à¸¹à¸™à¸¢à¹Œ à¸¡à¸¹à¸¥à¸„à¹ˆà¸²à¸­à¸¢à¸¹à¹ˆà¸—à¸µà¹ˆ 'à¹„à¸­à¹€à¸”à¸µà¸¢' à¹„à¸¡à¹ˆà¹ƒà¸Šà¹ˆ 'à¸à¸²à¸£à¸¥à¸‡à¸¡à¸·à¸­à¸—à¸³' à¸­à¸µà¸à¸•à¹ˆà¸­à¹„à¸›"
    },
    metrics: [
      { label: "Cost", value: "Low" },
      { label: "Quality", value: "8K" }
    ]
  },
  {
    id: 'n6',
    title: { en: "NVIDIA's Secret AI Moat ðŸ›¡ï¸", th: "à¸„à¸¹à¹€à¸¡à¸·à¸­à¸‡à¸¥à¸±à¸šà¸‚à¸­à¸‡ NVIDIA ðŸ›¡ï¸" },
    subtitle: { en: "Why your GPU is about to become obsolete.", th: "à¸—à¸³à¹„à¸¡à¸à¸²à¸£à¹Œà¸”à¸ˆà¸­à¸„à¸¸à¸“à¸à¸³à¸¥à¸±à¸‡à¸ˆà¸°à¸•à¸à¸£à¸¸à¹ˆà¸™" },
    source: "Nvidia Blog",
    sourceUrl: "https://nvidianews.nvidia.com",
    time: daysAgo(5),
    category: "Business",
    impactScore: 88,
    sentiment: "bullish",
    assets: ["NVDA"],
    summary: {
      en: "Jensen Huang just dropped a bombshell. It's not about training anymore; it's about 'Inference Time Compute'. The new Blackwell chips are designed for AI that thinks before it speaks. If you're holding crypto-mining GPUs, dump them. The hardware paradigm has shifted.",
      th: "Jensen Huang à¸—à¸´à¹‰à¸‡à¸£à¸°à¹€à¸šà¸´à¸”à¸¥à¸¹à¸à¹ƒà¸«à¸à¹ˆ à¸¡à¸±à¸™à¹„à¸¡à¹ˆà¹ƒà¸Šà¹ˆà¹à¸„à¹ˆà¹€à¸£à¸·à¹ˆà¸­à¸‡à¸à¸²à¸£à¹€à¸—à¸£à¸™à¸­à¸µà¸à¸•à¹ˆà¸­à¹„à¸› à¹à¸•à¹ˆà¸„à¸·à¸­ 'Inference Time Compute' à¸Šà¸´à¸› Blackwell à¹ƒà¸«à¸¡à¹ˆà¸–à¸¹à¸à¸­à¸­à¸à¹à¸šà¸šà¸¡à¸²à¹ƒà¸«à¹‰ AI 'à¸„à¸´à¸”à¸à¹ˆà¸­à¸™à¸žà¸¹à¸”' à¹ƒà¸„à¸£à¸–à¸·à¸­à¸à¸²à¸£à¹Œà¸”à¸ˆà¸­à¸‚à¸¸à¸”à¹€à¸«à¸£à¸µà¸¢à¸à¸­à¸¢à¸¹à¹ˆ à¸‚à¸²à¸¢à¸—à¸´à¹‰à¸‡à¸‹à¸° à¹‚à¸¥à¸à¸®à¸²à¸£à¹Œà¸”à¹à¸§à¸£à¹Œà¹€à¸›à¸¥à¸µà¹ˆà¸¢à¸™à¹„à¸›à¹à¸¥à¹‰à¸§"
    },
    aiTakeaway: {
      en: "The industry is pivoting from 'Fast AI' to 'Smart AI'. Hardware requirements are skyrocketing.",
      th: "à¸­à¸¸à¸•à¸ªà¸²à¸«à¸à¸£à¸£à¸¡à¸à¸³à¸¥à¸±à¸‡à¹€à¸›à¸¥à¸µà¹ˆà¸¢à¸™à¸ˆà¸²à¸ 'AI à¸—à¸µà¹ˆà¹€à¸£à¹‡à¸§' à¹€à¸›à¹‡à¸™ 'AI à¸—à¸µà¹ˆà¸‰à¸¥à¸²à¸”' à¸ªà¹€à¸›à¸„à¸®à¸²à¸£à¹Œà¸”à¹à¸§à¸£à¹Œà¸à¸³à¸¥à¸±à¸‡à¸žà¸¸à¹ˆà¸‡à¸—à¸°à¸¢à¸²à¸™"
    },
    metrics: [
      { label: "Stocks", value: "Buy" },
      { label: "Tech", value: "New" }
    ]
  }
];

// Reserve news for live injection
const RESERVE_NEWS = [
  {
    title: { en: "Perplexity vs Google: The War is Over ðŸ”", th: "Perplexity vs Google: à¸ªà¸‡à¸„à¸£à¸²à¸¡à¸ˆà¸šà¹à¸¥à¹‰à¸§ ðŸ”" },
    subtitle: { en: "Why I deleted Chrome for this AI browser.", th: "à¸—à¸³à¹„à¸¡à¸œà¸¡à¸¥à¸š Chrome à¸—à¸´à¹‰à¸‡à¹€à¸žà¸·à¹ˆà¸­ AI Browser à¸™à¸µà¹‰" },
    source: "The Verge",
    sourceUrl: "https://perplexity.ai",
    category: "Tool Launch",
    impactScore: 91,
    sentiment: "bullish",
    assets: ["GOOGL"],
    summary: {
      en: "Blue links are dead. SEO spam is over. Perplexity gives you the answer, cites the source, and moves on. We compared search speeds for research tasks: Google took 15 mins, Perplexity took 45 seconds. Here is why 'Answer Engines' are the new homepage of the internet.",
      th: "à¸¥à¸´à¸‡à¸à¹Œà¸ªà¸µà¸Ÿà¹‰à¸²à¸•à¸²à¸¢à¹à¸¥à¹‰à¸§ SEO à¸‚à¸¢à¸°à¸ˆà¸šà¸ªà¸´à¹‰à¸™ Perplexity à¹ƒà¸«à¹‰à¸„à¸³à¸•à¸­à¸š à¸­à¹‰à¸²à¸‡à¸­à¸´à¸‡à¹à¸«à¸¥à¹ˆà¸‡à¸—à¸µà¹ˆà¸¡à¸² à¹à¸¥à¹‰à¸§à¹„à¸›à¸•à¹ˆà¸­ à¹€à¸£à¸²à¹€à¸—à¸µà¸¢à¸šà¸„à¸§à¸²à¸¡à¹€à¸£à¹‡à¸§à¸à¸²à¸£à¸„à¹‰à¸™à¸«à¸²: Google à¹ƒà¸Šà¹‰ 15 à¸™à¸²à¸—à¸µ Perplexity à¹ƒà¸Šà¹‰ 45 à¸§à¸´à¸™à¸²à¸—à¸µ à¸™à¸µà¹ˆà¸„à¸·à¸­à¹€à¸«à¸•à¸¸à¸œà¸¥à¸§à¹ˆà¸²à¸—à¸³à¹„à¸¡ 'Answer Engines' à¸„à¸·à¸­à¸«à¸™à¹‰à¸²à¹à¸£à¸à¹ƒà¸«à¸¡à¹ˆà¸‚à¸­à¸‡à¸­à¸´à¸™à¹€à¸—à¸­à¸£à¹Œà¹€à¸™à¹‡à¸•"
    },
    aiTakeaway: {
      en: "Search behavior is fundamentally changing. SEO strategies must pivot to LLM Optimization (LLMO).",
      th: "à¸žà¸¤à¸•à¸´à¸à¸£à¸£à¸¡à¸à¸²à¸£à¸„à¹‰à¸™à¸«à¸²à¹€à¸›à¸¥à¸µà¹ˆà¸¢à¸™à¹„à¸›à¸­à¸¢à¹ˆà¸²à¸‡à¸ªà¸´à¹‰à¸™à¹€à¸Šà¸´à¸‡ à¸à¸¥à¸¢à¸¸à¸—à¸˜à¹Œ SEO à¸•à¹‰à¸­à¸‡à¹€à¸›à¸¥à¸µà¹ˆà¸¢à¸™à¹€à¸›à¹‡à¸™ LLM Optimization (LLMO)"
    },
    metrics: [{ label: "Speed", value: "20x" }]
  },
  {
    title: { en: "Midjourney v7: Photorealism Solved ðŸŽ¨", th: "Midjourney v7: à¸„à¸§à¸²à¸¡à¸ªà¸¡à¸ˆà¸£à¸´à¸‡à¸£à¸°à¸”à¸±à¸šà¸£à¸¹à¸›à¸–à¹ˆà¸²à¸¢ ðŸŽ¨" },
    subtitle: { en: "You can't tell this isn't a photo anymore.", th: "à¹à¸¢à¸à¹„à¸¡à¹ˆà¸­à¸­à¸à¹à¸¥à¹‰à¸§à¸§à¹ˆà¸²à¹€à¸›à¹‡à¸™à¸£à¸¹à¸›à¸–à¹ˆà¸²à¸¢à¸«à¸£à¸·à¸­ AI" },
    source: "Discord",
    sourceUrl: "https://midjourney.com",
    category: "Social Promo",
    impactScore: 96,
    sentiment: "bullish",
    assets: ["ADBE"],
    summary: {
      en: "Skin pores. Lighting physics. Reflections. Midjourney v7 alpha is leaking and it is terrifyingly good. Brands are cancelling photoshoots and hiring 'Prompt Engineers' instead. We generated a catalogue of product shots for $0. The implications for e-commerce are massive.",
      th: "à¸£à¸¹à¸‚à¸¸à¸¡à¸‚à¸™ à¹à¸ªà¸‡à¹€à¸‡à¸² à¹€à¸‡à¸²à¸ªà¸°à¸—à¹‰à¸­à¸™ Midjourney v7 alpha à¸«à¸¥à¸¸à¸”à¸­à¸­à¸à¸¡à¸²à¹à¸¥à¸°à¸¡à¸±à¸™à¸™à¹ˆà¸²à¸à¸¥à¸±à¸§à¸¡à¸²à¸ à¹à¸šà¸£à¸™à¸”à¹Œà¸•à¹ˆà¸²à¸‡à¹† à¸à¸³à¸¥à¸±à¸‡à¸¢à¸à¹€à¸¥à¸´à¸à¸à¸­à¸‡à¸–à¹ˆà¸²à¸¢à¹à¸¥à¸°à¸ˆà¹‰à¸²à¸‡ 'Prompt Engineers' à¹à¸—à¸™ à¹€à¸£à¸²à¸¥à¸­à¸‡à¸ªà¸£à¹‰à¸²à¸‡à¹à¸„à¸•à¸•à¸²à¸¥à¹‡à¸­à¸à¸ªà¸´à¸™à¸„à¹‰à¸²à¸”à¹‰à¸§à¸¢à¸‡à¸š 0 à¸šà¸²à¸— à¸œà¸¥à¸à¸£à¸°à¸—à¸šà¸•à¹ˆà¸­ E-commerce à¸¡à¸«à¸²à¸¨à¸²à¸¥"
    },
    aiTakeaway: {
      en: "Visual content creation is fully commoditized. Brand identity is the only differentiator left.",
      th: "à¸à¸²à¸£à¸ªà¸£à¹‰à¸²à¸‡à¸„à¸­à¸™à¹€à¸—à¸™à¸•à¹Œà¸ à¸²à¸žà¸à¸¥à¸²à¸¢à¹€à¸›à¹‡à¸™à¸‚à¸­à¸‡à¹‚à¸«à¸¥à¹† à¸­à¸±à¸•à¸¥à¸±à¸à¸©à¸“à¹Œà¹à¸šà¸£à¸™à¸”à¹Œà¸„à¸·à¸­à¸ªà¸´à¹ˆà¸‡à¹€à¸”à¸µà¸¢à¸§à¸—à¸µà¹ˆà¸ªà¸£à¹‰à¸²à¸‡à¸„à¸§à¸²à¸¡à¹à¸•à¸à¸•à¹ˆà¸²à¸‡à¹„à¸”à¹‰"
    },
    metrics: [{ label: "Detail", value: "Ultra" }]
  }
];

// --- HELPER COMPONENTS ---

const Toast = ({ message, onClose }) => (
  <div className="fixed top-24 right-6 z-50 animate-in slide-in-from-right-10 fade-in duration-300">
    <div className="bg-[#1c1c1e] border border-white/10 text-white px-4 py-3 rounded-xl shadow-2xl flex items-center gap-3">
      <CheckCircle2 size={18} className="text-emerald-500" />
      <span className="text-sm font-medium">{message}</span>
      <button onClick={onClose} className="ml-2 text-gray-500 hover:text-white"><X size={14}/></button>
    </div>
  </div>
);

const GlassCard = ({ children, className = "", onClick, hoverEffect = true }) => (
  <div 
    onClick={onClick}
    className={`
      relative overflow-hidden backdrop-blur-xl bg-[#1c1c1e]/60 border border-white/5 
      rounded-3xl shadow-[0_8px_32px_rgba(0,0,0,0.12)] transition-all duration-500 ease-out
      ${hoverEffect ? 'hover:bg-[#2c2c2e]/70 hover:scale-[1.01] hover:shadow-2xl cursor-pointer' : ''}
      ${className}
    `}
  >
    {children}
  </div>
);

const Badge = ({ children, variant = "neutral" }) => {
  const variants = {
    neutral: "bg-white/10 text-gray-300 border-white/5",
    blue: "bg-blue-500/20 text-blue-300 border-blue-500/20",
    green: "bg-emerald-500/20 text-emerald-300 border-emerald-500/20",
    purple: "bg-purple-500/20 text-purple-300 border-purple-500/20",
    orange: "bg-orange-500/20 text-orange-300 border-orange-500/20"
  };
  return (
    <span className={`px-2.5 py-1 rounded-full text-[10px] font-medium border backdrop-blur-md ${variants[variant]}`}>
      {children}
    </span>
  );
};

const ImpactRing = ({ score }) => {
  const radius = 18;
  const circumference = 2 * Math.PI * radius;
  const strokeDashoffset = circumference - (score / 100) * circumference;
  return (
    <div className="relative w-12 h-12 flex items-center justify-center">
      <svg className="transform -rotate-90 w-12 h-12">
        <circle cx="24" cy="24" r={radius} stroke="rgba(255,255,255,0.1)" strokeWidth="3" fill="transparent" />
        <circle 
          cx="24" cy="24" r={radius} 
          stroke={score > 90 ? "#34c759" : score > 70 ? "#ff9f0a" : "#ff3b30"} 
          strokeWidth="3" 
          fill="transparent" 
          strokeDasharray={circumference} 
          strokeDashoffset={strokeDashoffset} 
          strokeLinecap="round"
        />
      </svg>
      <span className="absolute text-[10px] font-semibold text-white">{score}</span>
    </div>
  );
};

// --- CALENDAR COMPONENT ---

const CalendarWidget = ({ selectedDate, onSelectDate, newsData, lang }) => {
  const [currentDate, setCurrentDate] = useState(new Date());

  const daysInMonth = new Date(currentDate.getFullYear(), currentDate.getMonth() + 1, 0).getDate();
  const firstDayOfMonth = new Date(currentDate.getFullYear(), currentDate.getMonth(), 1).getDay();

  const monthNames = lang === 'th' 
    ? ["à¸¡à¸à¸£à¸²à¸„à¸¡", "à¸à¸¸à¸¡à¸ à¸²à¸žà¸±à¸™à¸˜à¹Œ", "à¸¡à¸µà¸™à¸²à¸„à¸¡", "à¹€à¸¡à¸©à¸²à¸¢à¸™", "à¸žà¸¤à¸©à¸ à¸²à¸„à¸¡", "à¸¡à¸´à¸–à¸¸à¸™à¸²à¸¢à¸™", "à¸à¸£à¸à¸Žà¸²à¸„à¸¡", "à¸ªà¸´à¸‡à¸«à¸²à¸„à¸¡", "à¸à¸±à¸™à¸¢à¸²à¸¢à¸™", "à¸•à¸¸à¸¥à¸²à¸„à¸¡", "à¸žà¸¤à¸¨à¸ˆà¸´à¸à¸²à¸¢à¸™", "à¸˜à¸±à¸™à¸§à¸²à¸„à¸¡"]
    : ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"];

  const weekDays = lang === 'th' 
    ? ['à¸­à¸²', 'à¸ˆ', 'à¸­', 'à¸ž', 'à¸žà¸¤', 'à¸¨', 'à¸ª']
    : ['S', 'M', 'T', 'W', 'T', 'F', 'S'];

  const prevMonth = () => {
    setCurrentDate(new Date(currentDate.getFullYear(), currentDate.getMonth() - 1, 1));
  };

  const nextMonth = () => {
    setCurrentDate(new Date(currentDate.getFullYear(), currentDate.getMonth() + 1, 1));
  };

  const hasNews = (day) => {
    const checkDate = new Date(currentDate.getFullYear(), currentDate.getMonth(), day);
    return newsData.some(n => {
      const nDate = new Date(n.time);
      return nDate.getDate() === day && 
             nDate.getMonth() === currentDate.getMonth() && 
             nDate.getFullYear() === currentDate.getFullYear();
    });
  };

  const isSelected = (day) => {
    if (!selectedDate) return false;
    return selectedDate.getDate() === day && 
           selectedDate.getMonth() === currentDate.getMonth() && 
           selectedDate.getFullYear() === currentDate.getFullYear();
  };

  const isToday = (day) => {
    const today = new Date();
    return today.getDate() === day && 
           today.getMonth() === currentDate.getMonth() && 
           today.getFullYear() === currentDate.getFullYear();
  };

  const renderDays = () => {
    const days = [];
    for (let i = 0; i < firstDayOfMonth; i++) {
      days.push(<div key={`empty-${i}`} className="h-10 w-10"></div>);
    }
    for (let d = 1; d <= daysInMonth; d++) {
      const active = hasNews(d);
      const selected = isSelected(d);
      days.push(
        <button 
          key={d} 
          onClick={() => onSelectDate(new Date(currentDate.getFullYear(), currentDate.getMonth(), d))}
          className={`
            h-10 w-10 rounded-full flex items-center justify-center text-sm relative transition-all
            ${selected ? 'bg-blue-600 text-white shadow-lg shadow-blue-500/30' : 'hover:bg-white/10 text-gray-300'}
            ${isToday(d) && !selected ? 'border border-blue-500/50 text-blue-400' : ''}
          `}
        >
          {d}
          {active && !selected && (
            <div className="absolute bottom-1.5 w-1 h-1 bg-emerald-500 rounded-full"></div>
          )}
        </button>
      );
    }
    return days;
  };

  return (
    <div className="bg-[#1c1c1e] p-6 rounded-3xl border border-white/5 animate-in fade-in zoom-in duration-300">
      <div className="flex justify-between items-center mb-6">
        <h3 className="text-lg font-semibold text-white">
          {monthNames[currentDate.getMonth()]} <span className="text-gray-500">{currentDate.getFullYear()}</span>
        </h3>
        <div className="flex gap-2">
          <button onClick={prevMonth} className="p-1 hover:bg-white/10 rounded-full text-gray-400 hover:text-white"><ChevronLeft size={18} /></button>
          <button onClick={nextMonth} className="p-1 hover:bg-white/10 rounded-full text-gray-400 hover:text-white"><ChevronRightIcon size={18} /></button>
        </div>
      </div>
      <div className="grid grid-cols-7 gap-1 mb-2 text-center">
        {weekDays.map((d, i) => (
          <div key={i} className="text-xs font-bold text-gray-600 w-10">{d}</div>
        ))}
      </div>
      <div className="grid grid-cols-7 gap-1 place-items-center">
        {renderDays()}
      </div>
    </div>
  );
};

// --- VIEW COMPONENTS ---

const DetailPanel = ({ item, onClose, onBookmark, isBookmarked, onShare, onOpenSource, lang, onBroadcast }) => {
  if (!item) return null;
  return (
    <div className="h-full flex flex-col p-8 md:p-12 animate-in slide-in-from-right-8 fade-in duration-500">
      {/* Header Actions */}
      <div className="flex justify-between items-start mb-8">
        <button onClick={onClose} className="p-2 bg-white/10 rounded-full hover:bg-white/20 transition-colors">
          <X size={18} className="text-white" />
        </button>
        <div className="flex gap-3">
           <button 
             onClick={() => onBroadcast(item)}
             className="p-2 bg-blue-500/20 hover:bg-blue-500/40 text-blue-400 hover:text-white rounded-full transition-all"
             title={UI_TEXT[lang].broadcastTg}
           >
             <Send size={18} />
           </button>
          <button 
             onClick={() => onBookmark(item)}
             className={`p-2 rounded-full transition-all ${isBookmarked ? 'bg-blue-500 text-white' : 'bg-white/10 text-gray-300 hover:bg-white/20'}`}
          >
            <Bookmark size={18} fill={isBookmarked ? "currentColor" : "none"} />
          </button>
          <button onClick={() => onShare(item)} className="p-2 bg-white/10 rounded-full hover:bg-white/20 text-gray-300">
            <Share2 size={18} />
          </button>
        </div>
      </div>

      {/* Content */}
      <div className="flex-1 overflow-y-auto custom-scrollbar pr-4">
        <div className="flex items-center gap-3 mb-6">
          <Badge variant="blue">{item.category}</Badge>
          <span className="text-gray-500 text-xs flex items-center gap-1">
             <CalendarIcon size={12}/> {new Date(item.time).toLocaleDateString(lang === 'th' ? 'th-TH' : undefined, { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' })}
          </span>
        </div>

        <h1 className="text-4xl md:text-5xl font-semibold text-white mb-4 tracking-tight leading-[1.1]">
          {item.title[lang]}
        </h1>
        <h2 className="text-xl text-gray-400 font-medium mb-8 leading-relaxed">
          {item.subtitle[lang]}
        </h2>

        {/* AI Insight Block */}
        <div className="bg-gradient-to-br from-[#2c2c2e] to-[#1c1c1e] p-6 rounded-3xl border border-white/5 mb-8 relative overflow-hidden group">
          <div className="absolute top-0 right-0 p-8 opacity-20 blur-2xl bg-blue-500/30 w-32 h-32 rounded-full -mr-10 -mt-10 pointer-events-none group-hover:bg-blue-400/40 transition-all duration-1000"></div>
          
          <div className="flex items-center gap-3 mb-4">
            <div className="w-8 h-8 rounded-full bg-gradient-to-tr from-indigo-500 to-purple-500 flex items-center justify-center">
              <Sparkles size={14} className="text-white" />
            </div>
            <span className="text-sm font-semibold text-transparent bg-clip-text bg-gradient-to-r from-indigo-300 to-purple-300">
              {UI_TEXT[lang].analysis}
            </span>
          </div>
          <p className="text-lg text-gray-200 leading-relaxed font-medium">"{item.aiTakeaway[lang]}"</p>
        </div>

        {/* Metrics Grid */}
        <div className="grid grid-cols-2 gap-4 mb-8">
          {item.metrics?.map((m, i) => (
            <div key={i} className="p-5 rounded-2xl bg-white/5 border border-white/5 backdrop-blur-sm">
              <div className="text-gray-500 text-xs font-medium uppercase tracking-wider mb-1">{m.label}</div>
              <div className="text-2xl font-semibold text-white tracking-tight">{m.value}</div>
            </div>
          ))}
        </div>

        <div className="prose prose-invert max-w-none mb-12">
          <p className="text-gray-400 text-lg leading-relaxed whitespace-pre-wrap">{item.summary[lang]}</p>
        </div>

        {/* Source Footer */}
        <div className="mt-auto border-t border-white/10 pt-6">
           <div className="flex items-center justify-between">
              <div className="flex items-center gap-2">
                 <img src={`https://ui-avatars.com/api/?name=${item.source}&background=random&color=fff&size=24`} className="w-6 h-6 rounded-md opacity-70" alt="source"/>
                 <span className="text-sm text-gray-400">{UI_TEXT[lang].source}: {item.source}</span>
              </div>
              <button 
                onClick={() => onOpenSource(item.sourceUrl)}
                className="flex items-center gap-2 px-6 py-3 bg-white text-black font-semibold rounded-full hover:bg-gray-200 transition-colors"
              >
                {UI_TEXT[lang].readReport} <ExternalLink size={16} />
              </button>
           </div>
        </div>
      </div>
    </div>
  );
};

const MarketView = ({ tickers, lang }) => (
    <div className="p-8 animate-in fade-in duration-500">
        <h2 className="text-3xl font-bold text-white mb-6">{UI_TEXT[lang].market}</h2>
        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8">
            {tickers.map((t,i) => (
                <div key={i} className="bg-[#1c1c1e] p-6 rounded-3xl border border-white/5">
                    <div className="flex justify-between items-start mb-4">
                        <span className="text-2xl font-bold text-white">{t.symbol}</span>
                        <Badge variant={t.change > 0 ? "green" : "neutral"}>{t.change > 0 ? "+" : ""}{t.change.toFixed(2)}%</Badge>
                    </div>
                    <div className="text-4xl font-mono text-gray-300 mb-2">${t.price.toFixed(2)}</div>
                    <div className="h-16 flex items-end gap-1">
                         {[...Array(10)].map((_, idx) => (
                             <div 
                                key={idx} 
                                className={`flex-1 rounded-t-sm ${t.change > 0 ? 'bg-emerald-500/20' : 'bg-rose-500/20'}`}
                                style={{ height: `${30 + Math.random() * 70}%` }}
                             ></div>
                         ))}
                    </div>
                </div>
            ))}
        </div>
        <div className="p-6 bg-[#1c1c1e] rounded-3xl border border-white/5">
             <div className="flex items-center gap-2 mb-4 text-gray-400">
                <AlertTriangle size={16} />
                <span className="text-sm font-medium">{UI_TEXT[lang].volatilityAlert}</span>
             </div>
             <p className="text-lg text-gray-200">
                 {UI_TEXT[lang].volatilityMsg}
             </p>
        </div>
    </div>
);

const SettingsView = ({ lang, autoTg, setAutoTg }) => (
    <div className="p-8 animate-in fade-in duration-500 max-w-2xl mx-auto">
        <h2 className="text-3xl font-bold text-white mb-8">{UI_TEXT[lang].prefTitle}</h2>
        
        <div className="space-y-6">
            <div className="bg-[#1c1c1e] p-6 rounded-3xl border border-white/5 flex items-center justify-between">
                <div className="flex items-center gap-4">
                    <div className="p-3 bg-blue-500/10 text-blue-400 rounded-full"><Bell size={20} /></div>
                    <div>
                        <div className="font-semibold text-white">{UI_TEXT[lang].pushNotif}</div>
                        <div className="text-sm text-gray-500">{UI_TEXT[lang].pushDesc}</div>
                    </div>
                </div>
                <div className="w-12 h-6 bg-blue-600 rounded-full relative cursor-pointer"><div className="absolute right-1 top-1 w-4 h-4 bg-white rounded-full"></div></div>
            </div>

            <div className="bg-[#1c1c1e] p-6 rounded-3xl border border-white/5 flex items-center justify-between">
                <div className="flex items-center gap-4">
                    <div className="p-3 bg-emerald-500/10 text-emerald-400 rounded-full"><RefreshCw size={20} /></div>
                    <div>
                        <div className="font-semibold text-white">{UI_TEXT[lang].autoStream}</div>
                        <div className="text-sm text-gray-500">{UI_TEXT[lang].autoStreamDesc}</div>
                    </div>
                </div>
                <div className="w-12 h-6 bg-emerald-600 rounded-full relative cursor-pointer"><div className="absolute right-1 top-1 w-4 h-4 bg-white rounded-full"></div></div>
            </div>
            
            <div className="bg-[#1c1c1e] p-6 rounded-3xl border border-white/5 flex items-center justify-between">
                <div className="flex items-center gap-4">
                    <div className="p-3 bg-sky-500/10 text-sky-400 rounded-full"><Send size={20} /></div>
                    <div>
                        <div className="font-semibold text-white">{UI_TEXT[lang].telegramAuto}</div>
                        <div className="text-sm text-gray-500">{UI_TEXT[lang].telegramDesc}</div>
                        <div className="text-xs text-sky-500 mt-1 font-mono">t.me/+sf3zHLY0QTpiZDZl</div>
                    </div>
                </div>
                <div 
                   className={`w-12 h-6 rounded-full relative cursor-pointer transition-colors ${autoTg ? 'bg-sky-500' : 'bg-gray-700'}`}
                   onClick={() => setAutoTg(!autoTg)}
                >
                  <div className={`absolute top-1 w-4 h-4 bg-white rounded-full transition-all ${autoTg ? 'right-1' : 'left-1'}`}></div>
                </div>
            </div>

            <div className="bg-[#1c1c1e] p-6 rounded-3xl border border-white/5">
                <h3 className="font-semibold text-white mb-4">{UI_TEXT[lang].dataSources}</h3>
                <div className="flex flex-wrap gap-2">
                    {['Bloomberg', 'TechCrunch', 'Reuters', 'AlphaSignal', 'HuggingFace', 'ProductHunt'].map(s => (
                        <Badge key={s} variant="neutral">{s}</Badge>
                    ))}
                </div>
                <p className="text-xs text-gray-500 mt-4">
                    Nexus Intelligence Engine aggregates data via NewsAPI and proprietary scrapers. 
                    Copyrights belong to respective publishers.
                </p>
            </div>
        </div>
    </div>
);

// --- MAIN APP COMPONENT ---

export default function NexusApp() {
  // State
  const [activeTab, setActiveTab] = useState('home'); // home, market, saved, settings, calendar
  const [activeCategory, setActiveCategory] = useState('all');
  const [selectedNews, setSelectedNews] = useState(null);
  const [searchQuery, setSearchQuery] = useState('');
  const [searchFocused, setSearchFocused] = useState(false);
  const [selectedDate, setSelectedDate] = useState(null);
  const [lang, setLang] = useState('en'); // 'en' | 'th'
  const [autoTg, setAutoTg] = useState(false);
  
  // Data State
  const [news, setNews] = useState(INITIAL_NEWS);
  const [tickers, setTickers] = useState(INITIAL_TICKERS);
  const [savedIds, setSavedIds] = useState(new Set());
  const [toastMsg, setToastMsg] = useState(null);

  // --- ACTIONS ---

  const showToast = (msg) => {
    setToastMsg(msg);
    setTimeout(() => setToastMsg(null), 3000);
  };

  const toggleSave = (item) => {
    const newSet = new Set(savedIds);
    if (newSet.has(item.id)) {
        newSet.delete(item.id);
        showToast(UI_TEXT[lang].unsaveToast);
    } else {
        newSet.add(item.id);
        showToast(UI_TEXT[lang].saveToast);
    }
    setSavedIds(newSet);
  };

  const handleShare = async (item) => {
     try {
         await navigator.clipboard.writeText(`${item.title[lang]} - Read more on Nexus`);
         showToast(UI_TEXT[lang].shareToast);
     } catch (err) {
         showToast("Shared to system dialog");
     }
  };

  const handleBroadcast = (item) => {
     // Simulate broadcast
     showToast(UI_TEXT[lang].tgSentToast);
     // In a real app, you would call backend API here
     console.log("Broadcasting to Telegram:", item.title[lang]);
     window.open(`https://t.me/share/url?url=${encodeURIComponent(item.sourceUrl)}&text=${encodeURIComponent(item.title[lang])}`, '_blank');
  };

  const openSource = (url) => {
      window.open(url, '_blank');
  };

  const handleDateSelect = (date) => {
    // If selecting the same date, deselect it
    if (selectedDate && date.toDateString() === selectedDate.toDateString()) {
      setSelectedDate(null);
    } else {
      setSelectedDate(date);
    }
  };

  // --- EFFECTS (Simulating Live Data) ---

  // 1. Ticker Heartbeat (Update prices every 3s)
  useEffect(() => {
    const interval = setInterval(() => {
      setTickers(prev => prev.map(t => ({
        ...t,
        price: t.price * (1 + (Math.random() - 0.5) * 0.002), // Small random fluctuation
        change: t.change + (Math.random() - 0.5) * 0.1
      })));
    }, 3000);
    return () => clearInterval(interval);
  }, []);

  // 2. News Injection (High Frequency Update - Every 10s)
  useEffect(() => {
    const interval = setInterval(() => {
       // 40% chance to add news if we have reserve items
       if (Math.random() > 0.6 && RESERVE_NEWS.length > 0) {
           const randomIndex = Math.floor(Math.random() * RESERVE_NEWS.length);
           const newItemTemplate = RESERVE_NEWS[randomIndex];
           
           const newItem = {
               ...newItemTemplate,
               id: `new-${Date.now()}`,
               time: Date.now()
           };
           
           setNews(prev => [newItem, ...prev]);
           showToast(`New Alert: ${newItem.title[lang]}`);
           
           // Auto-post simulation
           if (autoTg) {
             setTimeout(() => showToast(UI_TEXT[lang].tgSentToast), 1000);
           }
       }
    }, 10000); // Check every 10 seconds
    return () => clearInterval(interval);
  }, [lang, autoTg]);


  // --- FILTER LOGIC ---
  const displayedNews = useMemo(() => {
      let data = news;
      
      // Date Filter (Highest Priority)
      if (selectedDate) {
        data = data.filter(n => {
           const nDate = new Date(n.time);
           return nDate.getDate() === selectedDate.getDate() &&
                  nDate.getMonth() === selectedDate.getMonth() &&
                  nDate.getFullYear() === selectedDate.getFullYear();
        });
      }

      // Tab Filter
      if (activeTab === 'saved') {
          data = data.filter(n => savedIds.has(n.id));
      }

      // Category Filter (only apply if NOT in calendar tab to allow broad date searching)
      if (activeCategory !== 'all' && activeTab === 'home' && !selectedDate) {
          data = data.filter(n => n.category === activeCategory);
      }

      // Search Filter
      if (searchQuery) {
          const lowerQ = searchQuery.toLowerCase();
          data = data.filter(n => 
              n.title[lang].toLowerCase().includes(lowerQ) || 
              n.summary[lang].toLowerCase().includes(lowerQ) ||
              n.assets.some(a => a.toLowerCase().includes(lowerQ))
          );
      }
      return data;
  }, [news, activeCategory, searchQuery, activeTab, savedIds, selectedDate, lang]);


  // --- RENDER HELPERS ---
  const renderSidebarItem = (id, icon, label) => (
      <button 
        onClick={() => { setActiveTab(id); setSelectedNews(null); }}
        className={`w-12 h-12 flex items-center justify-center rounded-2xl transition-all duration-300 group relative
          ${activeTab === id ? 'bg-white text-black shadow-lg shadow-white/10' : 'text-gray-500 hover:text-white hover:bg-white/10'}
        `}
        title={label}
      >
        {React.createElement(icon, { size: 20, strokeWidth: activeTab === id ? 2.5 : 2 })}
        {activeTab === id && <div className="absolute -right-1 top-1/2 -translate-y-1/2 w-1 h-8 bg-white/20 rounded-l-full blur-sm" />}
      </button>
  );

  return (
    <div className="h-screen bg-black text-gray-100 font-sans selection:bg-blue-500/30 overflow-hidden flex flex-col">
      
      {/* Background Ambience */}
      <div className="fixed inset-0 z-0 pointer-events-none">
        <div className="absolute top-[-20%] left-[-10%] w-[600px] h-[600px] bg-blue-900/10 rounded-full blur-[120px] opacity-40 animate-pulse-slow"></div>
        <div className="absolute bottom-[-20%] right-[-10%] w-[500px] h-[500px] bg-indigo-900/10 rounded-full blur-[120px] opacity-30"></div>
      </div>

      {/* Toast Notification */}
      {toastMsg && <Toast message={toastMsg} onClose={() => setToastMsg(null)} />}

      {/* Navbar */}
      <header className="relative z-20 h-16 flex items-center justify-between px-6 border-b border-white/5 bg-black/50 backdrop-blur-xl">
        <div className="flex items-center gap-8">
          <div className="flex items-center gap-2 group cursor-pointer" onClick={() => setActiveTab('home')}>
            <div className="w-8 h-8 rounded-xl bg-white flex items-center justify-center shadow-[0_0_15px_rgba(255,255,255,0.2)] transition-transform group-hover:scale-95">
              <Cpu size={18} className="text-black" strokeWidth={2.5} />
            </div>
            <span className="font-semibold text-lg tracking-tight text-white group-hover:opacity-80 transition-opacity">Nexus</span>
          </div>
          
          {/* Live Ticker */}
          <div className="hidden md:flex items-center gap-6 overflow-hidden h-8 mask-gradient-x w-[500px]">
             <div className="flex items-center gap-6 animate-marquee">
               {[...tickers, ...tickers].map((t, i) => (
                 <div key={i} className="flex items-center gap-2 text-xs font-medium text-gray-400 whitespace-nowrap">
                   <span className="text-white">{t.symbol}</span>
                   <span className={t.change > 0 ? 'text-emerald-400' : 'text-rose-400'}>
                     {t.change > 0 ? '+' : ''}{t.change.toFixed(2)}%
                   </span>
                 </div>
               ))}
             </div>
          </div>
        </div>

        <div className="flex items-center gap-4">
           {/* Lang Switch */}
           <div className="flex bg-[#1c1c1e] rounded-full border border-white/10 p-1">
             <button 
                onClick={() => setLang('en')} 
                className={`px-3 py-1 text-xs font-bold rounded-full transition-all ${lang === 'en' ? 'bg-white text-black' : 'text-gray-500 hover:text-white'}`}
             >
               EN
             </button>
             <button 
                onClick={() => setLang('th')} 
                className={`px-3 py-1 text-xs font-bold rounded-full transition-all ${lang === 'th' ? 'bg-white text-black' : 'text-gray-500 hover:text-white'}`}
             >
               TH
             </button>
           </div>

           <div className={`hidden md:flex items-center bg-[#1c1c1e] border border-white/10 rounded-full px-4 py-2 transition-all duration-300 ${searchFocused ? 'w-80 ring-2 ring-blue-500/50 border-transparent' : 'w-64 hover:border-white/20'}`}>
             <Search size={14} className="text-gray-500 mr-2" />
             <input 
               type="text" 
               placeholder={UI_TEXT[lang].searchPlaceholder} 
               className="bg-transparent border-none outline-none text-sm text-white w-full placeholder-gray-500"
               onFocus={() => setSearchFocused(true)}
               onBlur={() => setSearchFocused(false)}
               value={searchQuery}
               onChange={(e) => setSearchQuery(e.target.value)}
             />
           </div>
           <button className="w-8 h-8 rounded-full bg-gradient-to-b from-gray-700 to-gray-900 border border-white/10 flex items-center justify-center font-bold text-xs">
             A
           </button>
        </div>
      </header>

      <div className="flex-1 flex overflow-hidden relative z-10">
        
        {/* Sidebar */}
        <aside className="hidden lg:flex flex-col items-center py-8 px-4 w-24">
          <div className="bg-[#1c1c1e]/80 backdrop-blur-xl border border-white/5 rounded-[2rem] p-3 flex flex-col gap-4 shadow-2xl">
            {renderSidebarItem('home', Layers, UI_TEXT[lang].dashboard)}
            {renderSidebarItem('calendar', CalendarIcon, UI_TEXT[lang].calendar)}
            {renderSidebarItem('market', Activity, UI_TEXT[lang].market)}
            {renderSidebarItem('saved', Bookmark, UI_TEXT[lang].saved)}
            <div className="w-8 h-[1px] bg-white/10 mx-auto my-1"></div>
            {renderSidebarItem('settings', Settings, UI_TEXT[lang].settings)}
          </div>
        </aside>

        {/* Main Content */}
        <main className="flex-1 overflow-y-auto custom-scrollbar p-6 lg:pl-0 lg:pr-6">
          
          {/* View: Settings */}
          {activeTab === 'settings' && <SettingsView lang={lang} autoTg={autoTg} setAutoTg={setAutoTg} />}

          {/* View: Market */}
          {activeTab === 'market' && <MarketView tickers={tickers} lang={lang} />}

          {/* View: Calendar (Full) */}
          {activeTab === 'calendar' && (
             <div className="max-w-6xl mx-auto h-full grid grid-cols-1 xl:grid-cols-12 gap-6">
                <div className="xl:col-span-4">
                   <h2 className="text-2xl font-semibold text-white mb-6">{UI_TEXT[lang].archive}</h2>
                   <CalendarWidget 
                      selectedDate={selectedDate} 
                      onSelectDate={handleDateSelect} 
                      newsData={news}
                      lang={lang}
                   />
                   <div className="mt-6 p-6 bg-[#1c1c1e] rounded-3xl border border-white/5">
                      <h4 className="text-sm font-semibold text-gray-300 mb-2">{UI_TEXT[lang].instructions}</h4>
                      <p className="text-xs text-gray-500 leading-relaxed">
                        {UI_TEXT[lang].calendarInstruct}
                      </p>
                   </div>
                </div>
                <div className="xl:col-span-8">
                   <h2 className="text-2xl font-semibold text-white mb-6">
                     {selectedDate ? `${UI_TEXT[lang].updatesFor} ${selectedDate.toLocaleDateString()}` : UI_TEXT[lang].selectDate}
                   </h2>
                   {displayedNews.length > 0 ? (
                      displayedNews.map((item) => (
                        <div key={item.id} className="mb-4">
                           <GlassCard 
                              onClick={() => setSelectedNews(item)}
                              className="p-6 flex items-start justify-between group hover:border-blue-500/30"
                            >
                                <div>
                                    <div className="flex items-center gap-2 mb-2">
                                        <Badge variant="blue">{item.category}</Badge>
                                        <span className="text-xs text-gray-500">{new Date(item.time).toLocaleTimeString()}</span>
                                    </div>
                                    <h3 className="text-lg font-semibold text-white group-hover:text-blue-400 transition-colors">{item.title[lang]}</h3>
                                    <p className="text-sm text-gray-400">{item.subtitle[lang]}</p>
                                </div>
                                <ImpactRing score={item.impactScore} />
                            </GlassCard>
                        </div>
                      ))
                   ) : (
                      <div className="flex flex-col items-center justify-center h-64 bg-white/5 rounded-3xl border border-dashed border-white/10">
                          <CalendarIcon className="text-gray-600 mb-4" size={48} />
                          <p className="text-gray-500">{UI_TEXT[lang].noUpdates}</p>
                      </div>
                   )}
                </div>
             </div>
          )}

          {/* View: Home / Saved */}
          {(activeTab === 'home' || activeTab === 'saved') && (
            <div className="max-w-[1600px] mx-auto h-full grid grid-cols-1 xl:grid-cols-12 gap-6">
              
              {/* Feed List */}
              <div className={`${selectedNews ? 'hidden xl:flex' : 'flex'} xl:col-span-5 flex-col gap-6`}>
                
                <div className="flex flex-col gap-4 mb-2">
                  <div className="flex items-baseline justify-between px-2">
                    <h2 className="text-2xl font-semibold text-white tracking-tight">
                        {activeTab === 'saved' ? UI_TEXT[lang].savedTitle : UI_TEXT[lang].briefing}
                    </h2>
                    <span className="text-sm text-gray-500 flex items-center gap-2">
                        <span className="w-2 h-2 rounded-full bg-emerald-500 animate-pulse"></span>
                        {UI_TEXT[lang].live}
                    </span>
                  </div>
                  
                  {/* Category Filters (Only on Home) */}
                  {activeTab === 'home' && (
                    <div className="flex gap-2 overflow-x-auto pb-2 scrollbar-hide mask-gradient-x-right">
                      {FILTER_CATEGORIES.map(cat => {
                        const Icon = cat.icon;
                        return (
                          <button
                            key={cat.id}
                            onClick={() => setActiveCategory(cat.id)}
                            className={`
                              flex items-center gap-2 px-4 py-2 rounded-full text-xs font-medium whitespace-nowrap transition-all
                              ${activeCategory === cat.id 
                                ? 'bg-white text-black shadow-lg shadow-white/20' 
                                : 'bg-white/5 text-gray-400 hover:bg-white/10 hover:text-white'}
                            `}
                          >
                            {Icon && <Icon size={12} />}
                            {cat.label[lang]}
                          </button>
                        )
                      })}
                    </div>
                  )}
                </div>

                {displayedNews.length === 0 ? (
                    <div className="flex flex-col items-center justify-center h-64 border border-dashed border-white/10 rounded-3xl">
                        <Search className="text-gray-600 mb-2" size={32} />
                        <p className="text-gray-500">{UI_TEXT[lang].noUpdates}</p>
                    </div>
                ) : (
                    displayedNews.map((item) => (
                      <GlassCard 
                        key={item.id} 
                        onClick={() => setSelectedNews(item)}
                        className={`p-6 ${selectedNews?.id === item.id ? 'ring-1 ring-blue-500/50 bg-[#2c2c2e]/80' : ''}`}
                      >
                        <div className="flex justify-between items-start mb-4">
                          <div className="flex items-center gap-2">
                            <div className="w-6 h-6 rounded-md bg-white/5 flex items-center justify-center">
                              <img 
                                src={`https://ui-avatars.com/api/?name=${item.source}&background=random&color=fff&size=24`} 
                                alt={item.source} 
                                className="w-4 h-4 rounded-sm opacity-80"
                              />
                            </div>
                            <span className="text-xs font-medium text-gray-400">{item.source}</span>
                            <span className="text-xs text-gray-600">â€¢</span>
                            <span className="text-xs text-gray-500">{new Date(item.time).toLocaleDateString()}</span>
                          </div>
                          <ImpactRing score={item.impactScore} />
                        </div>
                        
                        <h3 className="text-xl font-semibold text-white mb-2 leading-tight">
                          {item.title[lang]}
                        </h3>
                        <p className="text-sm text-gray-400 leading-relaxed mb-4 line-clamp-2">
                          {item.summary[lang]}
                        </p>

                        <div className="flex items-center justify-between mt-auto pt-4 border-t border-white/5">
                          <div className="flex gap-2">
                            <Badge variant={
                              item.category === 'Success Case' ? 'green' : 
                              item.category === 'Tool Launch' ? 'purple' : 
                              item.category === 'Tips & Tricks' ? 'orange' : 'neutral'
                            }>{item.category}</Badge>
                          </div>
                          <span className="text-xs text-blue-400 font-medium flex items-center gap-1 group-hover:translate-x-1 transition-transform">
                            {UI_TEXT[lang].analysis} <ChevronRight size={12} />
                          </span>
                        </div>
                      </GlassCard>
                    ))
                )}
              </div>

              {/* Detail Column (Desktop) */}
              <div className="hidden xl:flex xl:col-span-7 h-[calc(100vh-8rem)] sticky top-6">
                 <div className="w-full h-full rounded-[2.5rem] bg-[#161617] border border-white/5 shadow-2xl overflow-hidden relative">
                   {selectedNews ? (
                     <DetailPanel 
                        item={selectedNews} 
                        onClose={() => setSelectedNews(null)}
                        onBookmark={toggleSave}
                        isBookmarked={savedIds.has(selectedNews.id)}
                        onShare={handleShare}
                        onBroadcast={handleBroadcast}
                        onOpenSource={openSource}
                        lang={lang}
                     />
                   ) : (
                     <div className="h-full flex flex-col items-center justify-center text-gray-600">
                       <div className="w-24 h-24 rounded-full bg-white/5 flex items-center justify-center mb-6 animate-pulse">
                         <Zap size={32} className="opacity-20" />
                       </div>
                       <p className="font-medium text-lg">Select an intelligence item</p>
                     </div>
                   )}
                 </div>
              </div>
            </div>
          )}
        </main>

        {/* Mobile Detail Modal */}
        {selectedNews && (
          <div className="xl:hidden fixed inset-0 z-50 bg-[#000000] animate-in slide-in-from-bottom-full duration-300">
             <DetailPanel 
                item={selectedNews} 
                onClose={() => setSelectedNews(null)}
                onBookmark={toggleSave}
                isBookmarked={savedIds.has(selectedNews.id)}
                onShare={handleShare}
                onBroadcast={handleBroadcast}
                onOpenSource={openSource}
                lang={lang}
             />
          </div>
        )}

      </div>

      <style>{`
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        .font-sans { font-family: 'Inter', sans-serif; }
        .custom-scrollbar::-webkit-scrollbar { width: 0px; }
        .mask-gradient-x { mask-image: linear-gradient(to right, transparent, black 10%, black 90%, transparent); }
        .mask-gradient-x-right { mask-image: linear-gradient(to right, black 85%, transparent); }
        .animate-pulse-slow { animation: pulse 8s cubic-bezier(0.4, 0, 0.6, 1) infinite; }
        .scrollbar-hide::-webkit-scrollbar { display: none; }
        .scrollbar-hide { -ms-overflow-style: none; scrollbar-width: none; }
        
        @keyframes marquee {
          0% { transform: translateX(0); }
          100% { transform: translateX(-50%); }
        }
        .animate-marquee { animation: marquee 20s linear infinite; }
        
        @keyframes pulse { 0%, 100% { opacity: 0.3; } 50% { opacity: 0.1; } }
      `}</style>
    </div>
  );
}
